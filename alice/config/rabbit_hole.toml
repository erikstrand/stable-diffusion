in_dir = "alice/frames"
out_dir = "alice/outputs/rabbit_hole"
width = 960
height = 720

# todo
# review graveyard seed test 2

[prompts]
tombstone = "an old tombstone in a grassy graveyard, weathered, by Kilian Eng and Esao Andrews"
graveyard = "new orleans style graveyard, grass, mossy tombstones, human bones, thick fog, volumetric lighting, cinematic, key light, rim light, by evgeny lushpin, by essao andrews, by inessa garmash"
jackrabbit = "a portrait of jack skelington as a rabbit, demon eyes, steampunk, dark atmospheric, by Kilian Eng and Esao Andrews"
witch = "portrait of a wicked witch with blonde hair crying blood, by greg rutkowski, by ross tran, by fenghua zhong, horror, octane, soft render, oil on canvas, moody lighting, high contrast, cinematic, trending on artstation, masterpiece"
witch2 = "portrait of a wicked witch with blonde hair and countless sharp teeth crying blood, by greg rutkowski, by ross tran, by fenghua zhong, horror, octane, soft render, oil on canvas, moody lighting, high contrast, cinematic, trending on artstation, masterpiece"
witch3 = "a painting of a blonde witch with demon eyes in a blue dress splattered with blood crawling in a tunnel in the catacombs, alice in wonderland, dramatic lighting, shattered bones, chiaroscuro, high detail, painted by greg rutkowski, painted by igor kieryluk, painted by bobby chiu, trending on artstation"
skull = "a weathered skull in a grassy graveyard, by Kilian Eng, by Esao Andrews, cinematic, high contrast"
pit = "the cheshire cat stares down a deep pit lined with decaying human skulls, piles of skulls, gnarled black roots, fire consumes all, smiling as the viewer falls to their death, highly detailed matte painting, by kilian eng, by esao andrews"
falling = "a blonde witch in a blue dress with blood stains falls into a dimensional rift, alice in wonderland, front facing, horror, sharp details, cinematic, dynamic lighting, clear face, high contrast, by Raphael Lacoste and Delphin Enjolras and William Bliss Baker"
forest_demon = "a snarling demon with glowing red eyes hidden in dense green leafy foliage, fresh kill, drool, horror, cinematic, high contrast, intricate details, by esao andrews, by ignacio fernandes rios, by evgeny lushpin, cgsociety"
skull_wall = "floral skulls covered in moss, embedded in a grassy dirt wall, ancient decay, cinematic, high contrast, by esao andrews, by evgeny lushpin, by jason gonzalez, by hannah yata, trending on artstation"
vampire_queen = "a wicked vampire queen with bloody fangs, perfect face, blue dress, blonde hair, cinematic, stunning, horror, highly detailed, digital painting, artstation, smooth, hard focus, illustration, art by esao andrews and artgerm and greg rutkowski and alphonse mucha"
gaping_maw = "digital painting of a wet smily undead drowned monster at the bottom of a deep hole, with translucent and veiny skin, long freaky finger, by filipe pagliuso and justin gerard, fantasy, highly detailed, realistic, intricate, glowing eyes"


# ==================================================
# cat paws at alice
# status: done, let's just use this as is. copied into rabbit_hole_final
[[keyframes]]
frame = 86
input_image = "rabbit_hole/IM{0086}.png"
prompt = "skull"
seed = 1234
strength = 0.0

# ==================================================
# alice and cat relaxing on grass
# status: done, added skull, rabbit_hole_final
[[keyframes]]
frame = 138
input_image = "rabbit_hole/IM{0138}.png"
prompt = "skull"
seed = 2922644564 # actually gives a skull (only one out of 100 random seeds)
# previously explored seeds for tombstone prompt: 438989805 1136108454
scale = 8.0
strength = 0.0
masks = [
    { center = [0.95, 0.4], radius = 0.25 }
]
steps = 50

[[keyframes]]
frame = 148
strength = 0.6

[[keyframes]]
frame = 160
strength = 0.8

[[keyframes]]
frame = 179
strength = 0.8

[[keyframes]]
frame = 188
strength = 0.6

[[keyframes]]
frame = 189
strength = 0.0
masks = []

# ==================================================
# zoom in on alice
# status: done, add tombstones, rabbit_hole_final
[[keyframes]]
frame = 190
prompt = "tombstone"
seed = 438989805 # gives a coherent tombstone
masks = [
    { center = [0.95, 0.4], radius = 0.25 },
    { center = [0.95, 0.5], radius = 0.25 },
    { center = [0.95, 0.6], radius = 0.25 },
]
strength = 0.8

[[keyframes]]
frame = 222

[[keyframes]]
frame = 231
strength = 0.666

# camera starts panning up
[[keyframes]]
frame = 232
strength = 0.0
masks = []


# ==================================================
# rabbit checks pocketwatch then starts running
# status: done, late_animation_3_nocc
[[keyframes]]
frame = 242
prompt = "jackrabbit"
# new seeds ("late_seed_test")
#3075280817 # 279
#3259052811 # 285
#1973214822 # 297**
#338444264 # 300
#3673561638 # 310
#3582477022 # 314
seed = 2727210979 # 321***
#2955633092 # 327
#943239974 # 328*
#1722989659 # 334*
#3208399878 # 347
#687117441 # 357
#2561557300 # 359
# old seeds
#seed = 232288432 # clock eye
#seed = 3853414560 # very coherent rabbit face
strength = 0.0
masks = []

# rabbit checks pocketwatch
[[keyframes]]
frame = 257
strength = 0.0
masks = [
    { center = [0.5, 0.55], radius = 0.3 }
]

[[keyframes]]
frame = 259
masks = [
    { center = [0.4, 0.5], radius = 0.3 }
]
strength = 0.2

[[keyframes]]
frame = 260
masks = [
    { center = [0.38, 0.68], radius = 0.35 }
]
strength = 0.3

[[keyframes]]
frame = 266
strength = 0.6
masks = [
    { center = [0.35, 0.68], radius = 0.4 }
]
set_color_reference = true

[[keyframes]]
frame = 267
fill_mask = "previous"
seed = "random"
strength = 0.3
correct_colors = true

[[keyframes]]
fill_mask = "none"
correct_colors = false
frame = 277

# rabbit starts running
[[keyframes]]
frame = 287
strength = 0.0
masks = []

[[keyframes]]
frame = 321
strength = 0.2
masks = []

# ==================================================
# alice and cat look in direction of rabbit, confused
# status: done, graveyard_scene_1
[[keyframes]]
frame = 322
input_image = "rabbit_hole/IM{0322}.png"
prompt = "graveyard"
# frames with good seeds good seeds (graveyard seed test 2)
#322, 334, 337, 343, 344, 349, 350, 354, 363, 364, 365, 368, 369, 370, 371
seed = 2844927732
strength = 0.6
masks = [
    { center = [0.1, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.1, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.85, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.85, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.35, 1.2], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.55, 1.2], radius = 0.6, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 340

[[keyframes]]
frame = 355
masks = [
    { center = [0.1, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.1, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.85, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.85, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.35, 1.35], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.55, 1.35], radius = 0.6, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 370
masks = [
    { center = [0.1, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.1, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.85, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.85, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.35, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.55, 1.5], radius = 0.6, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 381
strength = 0.6

# ==================================================
# zoom in on cat
# status: done, use as is, rabbit_hole_final
[[keyframes]]
frame = 382
strength = 0.0
masks = []

# ==================================================
# alice and cat follow (jumping on stones to cross river)
# status: done, graveyard_scene_2
[[keyframes]]
frame = 416
prompt = "graveyard"
seed = 2844927732
strength = 0.6
masks = [
    { center = [0.1, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.1, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.9, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.9, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.35, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.55, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [-0.4, 0.8], radius = 0.4, sigmoid_k = 0.1 },
    { center = [-0.4, 0.6], radius = 0.4, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 428
masks = [
    { center = [0.15, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.15, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.97, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.97, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.4, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.6, 1.7], radius = 0.6, sigmoid_k = 0.1 },
    { center = [-0.2, 0.8], radius = 0.4, sigmoid_k = 0.1 },
    { center = [-0.2, 0.6], radius = 0.4, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 440
masks = [
    { center = [0.4, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.4, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [1.2, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [1.2, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.65, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.85, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.05, 0.8], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.05, 0.65], radius = 0.4, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 446
masks = [
    { center = [0.7, 0.78], radius = 0.3, sigmoid_k = 0.1 },
    { center = [0.7, 0.69], radius = 0.3, sigmoid_k = 0.1 },
    { center = [1.5, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [1.5, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.95, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [1.15, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.4, 0.8], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.2, 0.9], radius = 0.6, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 450
masks = [
    { center = [0.8, 0.78], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.8, 0.69], radius = 0.4, sigmoid_k = 0.1 },
    { center = [2.0, 0.75], radius = 0.4, sigmoid_k = 0.1 },
    { center = [2.0, 0.65], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.95, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [1.15, 1.5], radius = 0.6, sigmoid_k = 0.1 },
    { center = [0.4, 0.8], radius = 0.4, sigmoid_k = 0.1 },
    { center = [0.2, 0.9], radius = 0.6, sigmoid_k = 0.1 },
]

[[keyframes]]
frame = 465
strength = 0.6

# ==================================================
# rabbit checks watch, runs. lots of motion
# status: don't use, everything is moving all the time
[[keyframes]]
frame = 466
strength = 0.0
masks = []
#544ish: waves at alice
#?: starts running again
#600: alice starts appearing in frame, following
#650: alice looks at cat. maybe add ominious creature in background?

# ==================================================
# rabbit running
# status: don't use
[[keyframes]]
frame = 743

# ==================================================
# cut to rabbit running into hole
# status: rendering two animation candidates
[[keyframes]]
frame = 813
input_image = "rabbit_hole/IM{0813}.png"
prompt = "forest_demon"
# good frames from seed search
# 814, 828, 861
seed = 2768682949
masks = [
    { center = [0.9, 1.2], radius = 0.65 }
]
strength = 0.6

#845ish: rabbit re-emerges to wave
#868: waving
#886: leaving
#910: alice appears
#935: peers in hole

[[keyframes]]
frame = 955
strength = 0.6
seed = 1872862534
# just need this when rendering the next frame!
masks = []

# ==================================================
# zoom in, alice peers into the rabbit hole
# status: rendering two candidates
#
# good frames (seed test 1, floral skulls)
# 957, 964, 970, 971, 974, 984, 997, 1008, 1017, 1020, 1030, 1045, 1062
# good frames (seed test 2, mushroom skulls)
# 973, 989
# good frames (seed test 3, skull fungus)
# 963, 967, 983
#
# want to try 974 -> 970 and 974 -> 984
# i.e. 880813338 -> 1973840922 and 880813338 -> 2029097179
# 974 is dependent on the exact mask, so the zombie head doesn't look as cool, giving up

[[keyframes]]
frame = 956
input_image = "rabbit_hole/IM{0956}.png"
#masks = [] # just need this to render the previous frame
masks = [
    { center = [1.5, 0.25], radius = 1.0 },
    { center = [1.47, 0.75], radius = 1.0 },
    { center = [0.0, 1.4], radius = 0.7 },
    { center = [0.4, 1.6], radius = 0.7 },
    { center = [0.7, 1.6], radius = 0.7 },
]
prompt = "skull_wall"
seed = 1973840922
strength = 0.6
scale = 8.0

[[keyframes]]
frame = 972
masks = [
    { center = [1.5, 0.25], radius = 1.0 },
    { center = [1.47, 0.75], radius = 1.0 },
    { center = [0.0, 1.3], radius = 0.7 },
    { center = [0.4, 1.5], radius = 0.7 },
    { center = [0.7, 1.5], radius = 0.7 },
]

# 1090 alice starts crawling in

[[keyframes]]
frame = 1127

# ==================================================
# alice crawls into the rabbit hole (viewed from front)
# status: done (good enough), rabbit_hole_final
[[keyframes]]
frame = 1128
input_image = "rabbit_hole/IM{1128}.png"
prompt = "witch"
seed = 1640273403 # golden seed for frame 1186/1187
strength = 0.0
masks = []

[[keyframes]]
frame = 1172
masks = [
    { center = [0.77, 0.566], radius = 0.2 }
]

[[keyframes]]
frame = 1177
masks = [
    { center = [0.77, 0.566], radius = 0.2 }
]
strength = "interpolate"

[[keyframes]]
frame = 1182
masks = [
    { center = [0.74, 0.666], radius = 0.2 }
]
strength = 0.65

[[keyframes]]
frame = 1197
masks = [
    { center = [0.75, 0.666], radius = 0.2 }
]

[[keyframes]]
frame = 1198
masks = [
    { center = [0.77, 0.6], radius = 0.2 }
]

[[keyframes]]
frame = 1200
masks = [
    { center = [0.79, 0.52], radius = 0.2 }
]

[[keyframes]]
frame = 1206
masks = [
    { center = [0.79, 0.5], radius = 0.2 }
]

[[keyframes]]
# she starts moving to the right here (eventually leaving the frame)
frame = 1220
masks = []
strength = 0.0


# ==================================================
# alice crawls deeper into the rabbit hole (side view)
# status: done, crawling_animation_3
[[keyframes]]
frame = 1264
input_image = "rabbit_hole/IM{1264}.png"
prompt = "witch3"
strength = 0.0
seed = 2390586

[[keyframes]]
frame = 1310
strength = 0.0
masks = [
    { center = [0.65, 0.55], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1316
strength = "interpolate"
masks = [
    { center = [0.75, 0.7], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1324
strength = "interpolate"
masks = [
    { center = [0.7, 0.52], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1330
strength = "interpolate"

[[keyframes]]
frame = 1337
strength = "interpolate"
masks = [
    { center = [0.6, 0.7], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1349
strength = "interpolate"
masks = [
    { center = [0.4, 0.75], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1360
strength = 0.4
masks = [
    { center = [0.4, 0.75], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1367
masks = [
    { center = [0.4, 0.65], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1373
masks = [
    { center = [0.55, 0.75], radius = 0.25, sigmoid_k=0.1 }
]

[[keyframes]]
frame = 1383
strength = 0.4
masks = [
    { center = [0.52, 0.65], radius = 0.25, sigmoid_k=0.1 }
]

# alice falls 1390ish
[[keyframes]]
frame = 1393
strength = 0.0
masks = [
    { center = [0.65, 0.5], radius = 0.25, sigmoid_k=0.1 }
]

#cat enters frame to look, slips down slope but catches herself
[[keyframes]]
frame = 1412
masks = []

#peers after alice
[[keyframes]]
frame = 1500

# ==================================================
# alice falls, as seen by cat from above
# status: use as is, copied to rabbit_hole_final
[[keyframes]]
frame = 1514

# ==================================================
# cat peers down, as seen by alice (cat recedes into distance)
# status: done, nailed it (transitions to deforum animation), cat_wave_animation_7
[[keyframes]]
frame = 1562
input_image = "rabbit_hole/IM{1562}.png"
prompt = "pit"
seed = 3472986395
strength = 0.0
masks = []

[[keyframes]]
frame = 1575
strength = 0.5
set_color_reference = true

[[keyframes]]
frame = 1576
seed = "random"
input_image = "previous"
strength = 0.5
correct_colors = true
transform.zoom = 0.97
transform.translate = [-3.0, 6.0]
transform.rotate = 0.0

[[keyframes]]
frame = 1594
transform.zoom = 0.96
transform.translate = [0.0, 5.0]
transform.rotate = 0.005

# ==================================================
# alice tumbles through darkness
# status: done, none are great but fall_animation_1 works
[[keyframes]]
frame = 1618
transform = "none"
input_image = "rabbit_hole/IM{1618}.png"
prompt = "falling"
strength = 0.0
seed = 457348756
correct_colors = false

# dress acts as parachute
[[keyframes]]
frame = 1660
strength = 0.0

[[keyframes]]
frame = 1680
strength = 0.6

[[keyframes]]
frame = 1695
strength = 0.6

[[keyframes]]
frame = 1715
strength = 0.8

# ==================================================
# zoom in, alice stare into space as she floats down
# status: searching for seeds
#
# best seeds: 1739, 1742, 1749, 1751, 1754**, 1769*, 1770*, 1774
[[keyframes]]
frame = 1716
input_image = "rabbit_hole/IM{1716}.png"
prompt = "vampire_queen"
#seed = 398868574 # 1754
seed = 314934025 # 1770
strength = 0.0
masks = [
    { center = [0.5, 0.76], radius = 0.25 }
]

[[keyframes]]
frame = 1725
masks = [
    { center = [0.55, 0.7], radius = 0.25 }
]
strength = 0.0

[[keyframes]]
frame = 1735
masks = [
    { center = [0.48, 0.74], radius = 0.25 }
]
strength = 0.6

[[keyframes]]
frame = 1740
masks = [
    { center = [0.46, 0.76], radius = 0.25 }
]
strength = 0.6

[[keyframes]]
frame = 1752
masks = [
    { center = [0.59, 0.57], radius = 0.25 }
]
strength = 0.0

[[keyframes]]
frame = 1761
masks = [
    { center = [0.63, 0.52], radius = 0.25 }
]

# ==================================================
# alice's feet from her viewpoint
# status: rendering candidates
#
# best seeds: 1766, 1767, 1777, 1782, 1785, 1786, 1797
[[keyframes]]
frame = 1762
input_image = "rabbit_hole/IM{1762}.png"
prompt = "gaping_maw"
seed = 1281708734 # 1785
#seed = 3615780435 # 1786
strength = 0.7
scale = 10.0
masks = [
    { center = [0.55, 1.52], radius = 1.0 }
]

[[keyframes]]
frame = 1797
masks = [
    { center = [0.55, 1.48], radius = 1.0 }
]

# ==================================================
# back to zoomed in side view
# status: done, floating_animation_1
[[keyframes]]
frame = 1798
scale = 8.0
masks = []
strength = 0.0
prompt = "witch2"

#1820: apron starts rising
#1828: apron covers face
#1852: clear

#1890: side view of face
[[keyframes]]
frame = 1890
masks = [
    { center = [0.47, 0.55], radius = 0.23 }
]

[[keyframes]]
frame = 1909
strength = 0.5
masks = [
    { center = [0.43, 0.7], radius = 0.23 }
]

#1895: starts getting darker
#1916: head start turning toward camera
[[keyframes]]
frame = 1916
masks = [
    { center = [0.45, 0.71], radius = 0.23 }
]

#1920: head facing camera
[[keyframes]]
frame = 1924
masks = [
    { center = [0.48, 0.67], radius = 0.23 }
]

[[keyframes]]
frame = 1940
masks = [
    { center = [0.48, 0.57], radius = 0.23 }
]
strength = 0.55

[[keyframes]]
frame = 1945
masks = [
    { center = [0.45, 0.6], radius = 0.23 }
]

[[keyframes]]
frame = 1960
masks = [
    { center = [0.39, 0.65], radius = 0.23 }
]
strength = 0.4

#1950: stable darkness
[[keyframes]]
frame = 1971
masks = [
    { center = [0.39, 0.57], radius = 0.23 }
]
strength = 0.0

# ==================================================
# zooms out a bit
[[keyframes]]
frame = 1972
#2012: lamp appears at bottom
#2045: alice turns on lamp, other furniture is visible

# ==================================================
# cuts to lower view, only alice's legs in frame, mirror on right side
[[keyframes]]
frame = 2210
#2335: alice grabs book

# ==================================================
# close up of alice reading book
[[keyframes]]
frame = 2368

# ==================================================
# zoom back out
[[keyframes]]
frame = 2468
#2520: grandfather clock goes by on right, bent chimney on left
#2545: alice falls into chair
#2680: kettle over fire in stove on right
#2742: alice slips out of chair

# ==================================================
# only alice's feet visible, funnel below
[[keyframes]]
frame = 2810
#2870: halfway through funnel
#2900: narrowest point
#2940: restabilized, map coming into view
#3000: looking at map (alice is upside down)

# ==================================================
# zoom in, upside down alice looking at map
[[keyframes]]
frame = 3008
#3070: map leaving view

# ==================================================
# rabbit running away (upside down since alice is)
[[keyframes]]
frame = 3160
